{% load crispy_forms_tags %}

<div class="container">
    <div class="row my-5">
        <div class="col-12 col-lg-6 offset-lg-3">
            <h2 class="text-muted mb-5">Add Product Variant</h2>
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                {{ form|crispy }}
                <button type="submit" class="btn btn-dark rounded-0 my-4 px-5">Save Product Variant</button>
            </form>
        </div>
    </div>
</div>

{% block postloadjs %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const productSelect = document.getElementById('id_product');
    const sizeSelect = document.getElementById('id_size');

    productSelect.addEventListener('change', function() {
        const productId = this.value;
        if (!productId) return;

        fetch(`/products/get_sizes/${productId}/`)
            .then(response => response.json())
            .then(data => {
                sizeSelect.innerHTML = '';
                data.sizes.forEach(size => {
                    const option = document.createElement('option');
                    option.value = size.id;
                    option.textContent = size.name;
                    sizeSelect.appendChild(option);
                });
            });
    });
});
</script>
{% endblock %}